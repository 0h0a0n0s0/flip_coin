{"ast":null,"code":"// ( ... <script> 标签内的逻辑保持不变 ... )\nimport { ElMessage, ElMessageBox } from 'element-plus';\nexport default {\n  name: 'IpWhitelistView',\n  data() {\n    return {\n      loading: true,\n      addLoading: false,\n      tableData: [],\n      addForm: {\n        ip_range: '',\n        description: ''\n      },\n      addFormRules: {\n        ip_range: [{\n          required: true,\n          message: '请输入 IP / CIDR',\n          trigger: 'blur'\n        }, {\n          pattern: /^([0-9]{1,3}\\.){3}[0-9]{1,3}(\\/([0-9]|[1-2][0-9]|3[0-2]))$/,\n          message: '格式错误，请使用 CIDR (e.g., 1.2.3.4/32)',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created() {\n    this.fetchWhitelist();\n  },\n  methods: {\n    async fetchWhitelist() {\n      this.loading = true;\n      try {\n        this.tableData = await this.$api.getIpWhitelist();\n      } catch (error) {\n        console.error('Failed to fetch IP whitelist:', error);\n      } finally {\n        this.loading = false;\n      }\n    },\n    async handleAddIp() {\n      const formEl = this.$refs.addFormRef;\n      if (!formEl) return;\n      await formEl.validate(async valid => {\n        if (valid) {\n          this.addLoading = true;\n          try {\n            await this.$api.addIpToWhitelist(this.addForm);\n            ElMessage.success('IP 新增成功');\n            formEl.resetFields();\n            await this.fetchWhitelist();\n          } catch (error) {\n            console.error('Failed to add IP:', error);\n          } finally {\n            this.addLoading = false;\n          }\n        } else {\n          return false;\n        }\n      });\n    },\n    handleDelete(row) {\n      ElMessageBox.confirm(`确定要刪除 IP 规則 \"${row.ip_range}\" 吗？`, '警告', {\n        confirmButtonText: '确定刪除',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(async () => {\n        try {\n          await this.$api.deleteIpFromWhitelist(row.id);\n          ElMessage.success('IP 规則刪除成功');\n          await this.fetchWhitelist();\n        } catch (error) {\n          console.error('Failed to delete IP:', error);\n        }\n      }).catch(() => {});\n    },\n    formatDateTime(isoString) {\n      if (!isoString) return '';\n      try {\n        return new Date(isoString).toLocaleString('zh-TW', {\n          timeZone: 'Asia/Taipei'\n        });\n      } catch (e) {\n        return isoString;\n      }\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}