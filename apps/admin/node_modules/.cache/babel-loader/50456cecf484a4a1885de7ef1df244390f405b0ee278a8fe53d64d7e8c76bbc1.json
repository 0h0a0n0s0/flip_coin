{"ast":null,"code":"// ( ... <script> 标签内的逻辑保持不变 ... )\nconst createTodayRange = () => {\n  const start = new Date();\n  start.setHours(0, 0, 0, 0);\n  const end = new Date();\n  end.setHours(23, 59, 59, 999);\n  return [start, end];\n};\nconst toIsoRange = range => {\n  if (!Array.isArray(range) || range.length !== 2) return null;\n  const [start, end] = range;\n  const startIso = start instanceof Date && !isNaN(start) ? start.toISOString() : null;\n  const endIso = end instanceof Date && !isNaN(end) ? end.toISOString() : null;\n  if (!startIso || !endIso) return null;\n  return [startIso, endIso];\n};\nexport default {\n  name: 'BetManagementView',\n  data() {\n    return {\n      loading: false,\n      tableData: [],\n      totalItems: 0,\n      pagination: {\n        page: 1,\n        limit: 10\n      },\n      searchParams: {\n        betId: '',\n        userId: '',\n        status: '',\n        dateRange: createTodayRange()\n      }\n    };\n  },\n  created() {\n    this.handleSearch();\n  },\n  methods: {\n    async fetchBets() {\n      if (this.loading) return;\n      this.loading = true;\n      try {\n        const isoRange = toIsoRange(this.searchParams.dateRange);\n        const params = {\n          ...this.pagination,\n          betId: this.searchParams.betId || undefined,\n          userId: this.searchParams.userId || undefined,\n          status: this.searchParams.status || undefined,\n          dateRange: isoRange ? JSON.stringify(isoRange) : undefined\n        };\n        const response = await this.$api.getBets(params);\n        this.tableData = response.list;\n        this.totalItems = response.total;\n      } catch (error) {\n        console.error('Failed to fetch bets:', error);\n      } finally {\n        this.loading = false;\n      }\n    },\n    handleSearch() {\n      this.pagination.page = 1;\n      this.fetchBets();\n    },\n    handleSizeChange(newLimit) {\n      this.pagination.limit = newLimit;\n      this.pagination.page = 1;\n      this.fetchBets();\n    },\n    handlePageChange(newPage) {\n      this.pagination.page = newPage;\n      this.fetchBets();\n    },\n    formatDateTime(isoString) {\n      if (!isoString) return '';\n      try {\n        return new Date(isoString).toLocaleString('zh-TW', {\n          timeZone: 'Asia/Taipei'\n        });\n      } catch (e) {\n        return isoString;\n      }\n    },\n    formatStatus(status) {\n      const map = {\n        'pending': '处理中',\n        'won': '中奖',\n        'lost': '未中奖',\n        'failed': '失败'\n      };\n      return map[status] || status;\n    },\n    getStatusTagType(status) {\n      const map = {\n        'pending': 'info',\n        'won': 'success',\n        'lost': 'danger',\n        'failed': 'danger'\n      };\n      return map[status] || 'default';\n    },\n    formatChoice(choice) {\n      if (choice === 'head') return '正面';\n      if (choice === 'tail') return '反面';\n      return choice;\n    },\n    formatCurrency(value) {\n      if (value === null || value === undefined) return '';\n      if (parseFloat(value) === 0) return '-';\n      try {\n        const num = parseFloat(value);\n        if (isNaN(num)) return 'N/A';\n        return num.toFixed(2);\n      } catch (e) {\n        return 'N/A';\n      }\n    },\n    formatPrize(row) {\n      if (row.status === 'won') {\n        try {\n          const betAmount = parseFloat(row.amount);\n          const multiplier = parseInt(row.payout_multiplier, 10) || 2;\n          const prizeAmount = betAmount * multiplier;\n          return this.formatCurrency(prizeAmount);\n        } catch (e) {\n          return '计算错误';\n        }\n      }\n      return '-';\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}