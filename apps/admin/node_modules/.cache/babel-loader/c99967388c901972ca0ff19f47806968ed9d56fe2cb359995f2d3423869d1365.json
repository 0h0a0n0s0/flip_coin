{"ast":null,"code":"// ( ... <script> 标签内的逻辑保持不变 ... )\nimport { ElMessage } from 'element-plus';\nimport { InfoFilled } from '@element-plus/icons-vue';\nconst createTodayRange = () => {\n  const start = new Date();\n  start.setHours(0, 0, 0, 0);\n  const end = new Date();\n  end.setHours(23, 59, 59, 999);\n  return [start, end];\n};\nconst toIsoRange = range => {\n  if (!Array.isArray(range) || range.length !== 2) return null;\n  const [start, end] = range;\n  const startIso = start instanceof Date && !isNaN(start) ? start.toISOString() : null;\n  const endIso = end instanceof Date && !isNaN(end) ? end.toISOString() : null;\n  if (!startIso || !endIso) return null;\n  return [startIso, endIso];\n};\nexport default {\n  name: 'ReportManagementView',\n  components: {\n    InfoFilled\n  },\n  data() {\n    return {\n      loading: false,\n      searchParams: {\n        dateRange: createTodayRange(),\n        userQuery: 'system'\n      },\n      reportData: null\n    };\n  },\n  created() {\n    this.handleSearch();\n  },\n  methods: {\n    async handleSearch() {\n      if (!this.searchParams.dateRange) {\n        ElMessage.error('请选择时间范围');\n        return;\n      }\n      if (!this.searchParams.userQuery) {\n        ElMessage.error('请指定查询对象 (输入用户ID/钱包地址，或输入 system 查询全平台)');\n        return;\n      }\n      this.loading = true;\n      this.reportData = null;\n      try {\n        const isoRange = toIsoRange(this.searchParams.dateRange);\n        if (!isoRange) {\n          ElMessage.error('时间范围选择无效，请重新选择');\n          this.loading = false;\n          return;\n        }\n        const params = {\n          dateRange: JSON.stringify(isoRange),\n          userQuery: this.searchParams.userQuery.trim()\n        };\n        const response = await this.$api.getProfitLossReport(params);\n        this.reportData = response;\n      } catch (error) {\n        console.error('Failed to fetch profit-loss report:', error);\n      } finally {\n        this.loading = false;\n      }\n    },\n    formatCurrency(value) {\n      if (value === null || value === undefined) return '0.00';\n      if (typeof value !== 'number') {\n        try {\n          value = parseFloat(value);\n          if (isNaN(value)) return '0.00';\n        } catch (e) {\n          return '0.00';\n        }\n      }\n      // (★★★ 修正：v7 应为 USDT，显示 2 位小数 ★★★)\n      return value.toFixed(2);\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}