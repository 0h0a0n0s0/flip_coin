# Flip Coin é¡¹ç›®

ä¸€ä¸ªåŸºäºåŒºå—é“¾çš„æŠ•æ³¨æ¸¸æˆå¹³å°ï¼Œæ”¯æŒå¤šé“¾ï¼ˆTRC20ã€BSCã€ETHã€Polygonã€Solanaï¼‰USDT å……å€¼å’Œææ¬¾ã€‚

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

Flip Coin æ˜¯ä¸€ä¸ªåŸºäºåŒºå—é“¾çš„æŠ•æ³¨æ¸¸æˆå¹³å°ï¼Œé‡‡ç”¨ **Monorepo** æ¶æ„ï¼Œä½¿ç”¨ **pnpm workspace** ç®¡ç†å¤šä¸ªåº”ç”¨å’ŒåŒ…ã€‚é¡¹ç›®åŒ…å«å‰ç«¯ç”¨æˆ·ç•Œé¢ã€åå°ç®¡ç†ç³»ç»Ÿã€åç«¯ API æœåŠ¡ä»¥åŠå…±äº«çš„æ•°æ®åº“å’Œ UI ç»„ä»¶åŒ…ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ® **Flip Coin æŠ•æ³¨æ¸¸æˆ** - å®æ—¶é“¾ä¸Šå¼€å¥–
- ğŸ’° **å¤šé“¾é’±åŒ…æ”¯æŒ** - TRC20ã€BSCã€ETHã€Polygonã€Solana
- ğŸ” **HD é’±åŒ…ç®¡ç†** - è‡ªåŠ¨åˆ†é…ç”¨æˆ·å……å€¼åœ°å€
- âš¡ **è‡ªåŠ¨å……å€¼ç›‘å¬** - TRON é“¾è½®è¯¢ç›‘å¬ç”¨æˆ·å……å€¼
- ğŸ”„ **è‡ªåŠ¨å½’é›†** - Approve + TransferFrom åŒç­¾åå½’é›†
- ğŸ’¸ **è‡ªåŠ¨å‡ºæ¬¾** - TRC20-USDT è‡ªåŠ¨å‡ºæ¬¾
- ğŸ›¡ï¸ **å®‰å…¨é˜²æŠ¤** - IP ç™½åå•ã€é€Ÿç‡é™åˆ¶ã€é£æ§ç³»ç»Ÿ
- ğŸ“Š **åå°ç®¡ç†** - å®Œæ•´çš„ç”¨æˆ·ã€è´¢åŠ¡ã€æ¸¸æˆã€é£æ§ç®¡ç†

## ğŸ“ é¡¹ç›®ç»“æ„

```
flip_coin/
â”œâ”€â”€ apps/                              # åº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ web/                           # Vue 3 å‰ç«¯åº”ç”¨ (@flipcoin/web)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ api/                   # API è¯·æ±‚æ¨¡å—ï¼ˆç»Ÿä¸€å¤„ç†æ‰€æœ‰ HTTP è¯·æ±‚ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.js           # ç»Ÿä¸€ API å®¢æˆ·ç«¯ï¼Œç¦æ­¢ç›´æ¥ä½¿ç”¨ fetch()
â”‚   â”‚   â”‚   â”œâ”€â”€ components/            # Vue ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth/              # è®¤è¯ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginModal.vue      # ç™»å½•æ¨¡æ€æ¡†
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ RegisterModal.vue   # æ³¨å†Œæ¨¡æ€æ¡†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ common/            # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Banner.vue           # æ¨ªå¹…ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ History.vue          # å†å²è®°å½•
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Leaderboard.vue      # æ’è¡Œæ¦œ
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LanguageSwitcher.vue # è¯­è¨€åˆ‡æ¢
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SmallWinnerTicker.vue # å®æ—¶ä¸­å¥–æ»šåŠ¨
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TrendingGamesGrid.vue # çƒ­é—¨æ¸¸æˆç½‘æ ¼
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ game/              # æ¸¸æˆç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ FlipCoinGame.vue     # Flip Coin æ¸¸æˆä¸»ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ layout/            # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MainLayout.vue        # ä¸»å¸ƒå±€ï¼ˆSPA æ¶æ„ï¼‰
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header.vue            # é¡¶éƒ¨å¯¼èˆªæ 
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.vue            # é¡µè„š
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LeftSidebar.vue       # å·¦ä¾§è¾¹æ 
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TopCategoryNav.vue    # é¡¶éƒ¨åˆ†ç±»å¯¼èˆª
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MobileBottomNav.vue   # ç§»åŠ¨ç«¯åº•éƒ¨å¯¼èˆª
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ CompactHeroStrip.vue  # ç´§å‡‘å‹é¦–é¡µæ¨ªå¹…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ wallet/            # é’±åŒ…ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WalletModal.vue       # é’±åŒ…æ¨¡æ€æ¡†ï¼ˆå……å€¼/æç°ï¼‰
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PersonalCenter.vue    # ä¸ªäººä¸­å¿ƒ
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SetPasswordModal.vue  # è®¾ç½®ææ¬¾å¯†ç 
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ChangePasswordModal.vue # ä¿®æ”¹ææ¬¾å¯†ç 
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ui/                # UI ç»„ä»¶
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ GameCard.vue          # æ¸¸æˆå¡ç‰‡ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ composables/           # Composition API hooks
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useAuth.js         # è®¤è¯ç›¸å…³ï¼ˆç™»å½•ã€æ³¨å†Œã€ç™»å‡ºï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useGame.js         # æ¸¸æˆç›¸å…³ï¼ˆä¸‹æ³¨é€»è¾‘ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useWallet.js       # é’±åŒ…ç›¸å…³ï¼ˆå……å€¼ã€æç°ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useSocket.js       # Socket.IO è¿æ¥ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ useLanguage.js     # å¤šè¯­ç³»åˆ‡æ¢
â”‚   â”‚   â”‚   â”œâ”€â”€ views/                 # é¡µé¢è§†å›¾
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Home.vue           # é¦–é¡µï¼ˆHero Stripã€Trending Gamesã€Latest Winsï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FlipCoinGamePage.vue # Flip Coin æ¸¸æˆé¡µé¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GameListPage.vue   # æ¸¸æˆåˆ—è¡¨é¡µé¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BetHistoryPage.vue # æŠ•æ³¨å†å²é¡µé¢
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ HashGame.vue       # Hash æ¸¸æˆåˆ†ç±»é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ router/                # è·¯ç”±é…ç½®
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.js           # Vue Router é…ç½®ï¼ˆåµŒå¥—è·¯ç”±ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ store/                 # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.js           # Pinia storeï¼ˆJWT Tokenã€ç”¨æˆ·ä¿¡æ¯ã€æ¸¸æˆçŠ¶æ€ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ locales/               # å¤šè¯­ç³»æ–‡ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ index.js           # i18n é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ zh-TW.json         # ç¹ä½“ä¸­æ–‡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ zh-CN.json         # ç®€ä½“ä¸­æ–‡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ en.json            # è‹±æ–‡
â”‚   â”‚   â”‚   â”œâ”€â”€ styles/                # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ main.css           # ä¸»æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ tokens.css          # Design System tokensï¼ˆé¢œè‰²ã€é—´è·ã€åœ†è§’ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ notify.js          # ç»Ÿä¸€é€šçŸ¥ç³»ç»Ÿï¼ˆNotyfï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ scripts/               # è„šæœ¬
â”‚   â”‚   â”‚       â””â”€â”€ i18n-scanner.js    # i18n å­—ç¬¦ä¸²æ‰«æè„šæœ¬
â”‚   â”‚   â”œâ”€â”€ Dockerfile                 # Docker æ„å»ºæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ nginx.conf                 # Nginx é…ç½®
â”‚   â”‚   â”œâ”€â”€ vite.config.js             # Vite é…ç½®
â”‚   â”‚   â”œâ”€â”€ tailwind.config.js         # Tailwind CSS é…ç½®
â”‚   â”‚   â””â”€â”€ package.json               # ä¾èµ–é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ admin/                         # åå°ç®¡ç†å‰ç«¯ (@flipcoin/admin)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ views/                 # ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Layout.vue         # ç®¡ç†åå°å¸ƒå±€
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Login.vue          # ç®¡ç†å‘˜ç™»å½•é¡µ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.vue      # ä»ªè¡¨æ¿ï¼ˆç»Ÿè®¡æ•°æ®ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserManagement.vue # ç”¨æˆ·ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserDepositAddresses.vue # ç”¨æˆ·å……å€¼åœ°å€æŸ¥è¯¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BetManagement.vue  # æŠ•æ³¨ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ReportManagement.vue # æŠ¥è¡¨ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CollectionLogs.vue # å½’é›†æ—¥å¿—
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WalletMonitoring.vue # é’±åŒ…ç›‘æ§
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ admin/             # ç®¡ç†å‘˜ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AccountManagement.vue # è´¦å·ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Permissions.vue      # æƒé™ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IpWhitelist.vue     # IP ç™½åå•
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AuditLogs.vue       # å®¡è®¡æ—¥å¿—
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ finance/           # è´¢åŠ¡ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DepositHistory.vue  # å……å€¼è®°å½•
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WithdrawalReview.vue # æç°å®¡æ ¸
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BalanceChanges.vue  # è´¦å˜è®°å½•
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ games/             # æ¸¸æˆç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ GameManagement.vue  # æ¸¸æˆåˆ—è¡¨å’Œå‚æ•°è®¾ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ risk/              # é£æ§ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SameIpMonitor.vue   # åŒ IP ç›‘æ§
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ settings/          # ç³»ç»Ÿè®¾ç½®
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ GameParameters.vue  # æ¸¸æˆå‚æ•°
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ UserLevels.vue      # ç”¨æˆ·ç­‰çº§
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ I18nManagement.vue  # å¤šè¯­ç³»ç®¡ç†
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ BlockedRegions.vue  # åœ°åŒºå±è”½
â”‚   â”‚   â”‚   â”œâ”€â”€ components/            # ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GoogleAuthDialog.vue    # Google äºŒæ¬¡éªŒè¯å¯¹è¯æ¡†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ProfileDialog.vue        # ä¸ªäººèµ„æ–™å¯¹è¯æ¡†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TronNotificationDialog.vue # TRON é€šçŸ¥å¯¹è¯æ¡†
â”‚   â”‚   â”‚   â”œâ”€â”€ api/                   # API æ¨¡å—
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.js           # ç»Ÿä¸€ API å®¢æˆ·ç«¯ï¼ˆAxiosï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ router/                # è·¯ç”±é…ç½®
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.js           # Vue Router é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ store.js               # Vuex çŠ¶æ€ç®¡ç†ï¼ˆæƒé™ç®¡ç†ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚       â””â”€â”€ request.js         # Axios è¯·æ±‚æ‹¦æˆªå™¨
â”‚   â”‚   â”œâ”€â”€ Dockerfile                 # Docker æ„å»ºæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ nginx.conf                 # Nginx é…ç½®
â”‚   â”‚   â””â”€â”€ package.json               # ä¾èµ–é…ç½®
â”‚   â”‚
â”‚   â””â”€â”€ backend-legacy/                # åç«¯æœåŠ¡ (@flipcoin/backend-legacy)
â”‚       â”œâ”€â”€ routes/                    # API è·¯ç”±
â”‚       â”‚   â”œâ”€â”€ v1/                    # v1 API è·¯ç”±ï¼ˆå‰å°ç”¨æˆ· APIï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ index.js           # v1 è·¯ç”±ç»Ÿä¸€å…¥å£
â”‚       â”‚   â”‚   â”œâ”€â”€ auth.js            # è®¤è¯è·¯ç”±ï¼ˆæ³¨å†Œã€ç™»å½•ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ user.js            # ç”¨æˆ·è·¯ç”±ï¼ˆè·å–ç”¨æˆ·ä¿¡æ¯ã€æ›´æ–°æ˜µç§°ã€ç»‘å®šæ¨èäººï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ bet.js             # æŠ•æ³¨è·¯ç”±ï¼ˆä¸‹æ³¨ã€å†å²ã€æ’è¡Œæ¦œï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ wallet.js          # é’±åŒ…è·¯ç”±ï¼ˆè®¾ç½®/ä¿®æ”¹ææ¬¾å¯†ç ã€ææ¬¾ã€å……å€¼/ææ¬¾å†å²ï¼‰
â”‚       â”‚   â”‚   â””â”€â”€ game.js            # æ¸¸æˆè·¯ç”±ï¼ˆæ¸¸æˆåˆ—è¡¨ã€å¹³å°åç§°ï¼‰
â”‚       â”‚   â”œâ”€â”€ admin/                 # ç®¡ç† API è·¯ç”±ï¼ˆåå°ç®¡ç† APIï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ index.js           # ç®¡ç†è·¯ç”±ç»Ÿä¸€å…¥å£
â”‚       â”‚   â”‚   â”œâ”€â”€ auth.js            # ç®¡ç†å‘˜è®¤è¯ï¼ˆç™»å½•ã€è·å–æƒé™ã€ä¸ªäººèµ„æ–™ã€Google è®¤è¯ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ dashboard.js       # ä»ªè¡¨æ¿ï¼ˆç»Ÿè®¡æ•°æ®ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ users.js           # ç”¨æˆ·ç®¡ç†ï¼ˆç”¨æˆ·åˆ—è¡¨ã€æ›´æ–°ç”¨æˆ·ä¿¡æ¯ã€ç”¨æˆ·çŠ¶æ€ã€å……å€¼åœ°å€ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ bets.js            # æŠ•æ³¨ç®¡ç†ï¼ˆæŠ•æ³¨åˆ—è¡¨ã€ç›ˆäºæŠ¥è¡¨ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ wallets.js         # é’±åŒ…ç®¡ç†ï¼ˆå¹³å°é’±åŒ… CRUDã€é’±åŒ…ç›‘æ§ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ settings.js        # ç³»ç»Ÿè®¾ç½®ï¼ˆé€šç”¨è®¾ç½®ã€å¤šè¯­ç³»ã€åœ°åŒºå±è”½ã€ç”¨æˆ·ç­‰çº§ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ accounts.js        # è´¦å·ç®¡ç†ï¼ˆç®¡ç†å‘˜è´¦å· CRUDã€IP ç™½åå•ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ permissions.js     # æƒé™ç®¡ç†ï¼ˆè§’è‰² CRUDã€æƒé™åˆ—è¡¨ï¼‰
â”‚       â”‚   â”‚   â””â”€â”€ transactions.js    # äº¤æ˜“ç®¡ç†ï¼ˆå……å€¼ã€æç°ã€è´¦å˜è®°å½•ã€åŒ IP é£æ§ï¼‰
â”‚       â”‚   â””â”€â”€ admin.js               # ç®¡ç†è·¯ç”±ä¸»æ–‡ä»¶ï¼ˆå·²é‡æ„ä¸ºæ¨¡å—åŒ–ï¼‰
â”‚       â”‚
â”‚       â”œâ”€â”€ middleware/                # ä¸­é—´ä»¶
â”‚       â”‚   â”œâ”€â”€ adminIpWhitelistMiddleware.js # ç®¡ç†å‘˜ IP ç™½åå•æ£€æŸ¥
â”‚       â”‚   â”œâ”€â”€ auth.js                # èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼ˆJWTã€Passport.jsï¼‰
â”‚       â”‚   â”œâ”€â”€ checkPermissionMiddleware.js # æƒé™æ£€æŸ¥ä¸­é—´ä»¶
â”‚       â”‚   â”œâ”€â”€ ipBlockerMiddleware.js # IP å°ç¦æ£€æŸ¥
â”‚       â”‚   â””â”€â”€ rateLimiter.js         # é€Ÿç‡é™åˆ¶ï¼ˆæ³¨å†Œã€ç™»å½•ã€ææ¬¾ï¼‰
â”‚       â”‚
â”‚       â”œâ”€â”€ services/                  # ä¸šåŠ¡é€»è¾‘æœåŠ¡å±‚
â”‚       â”‚   â”œâ”€â”€ KmsService.js          # å¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆHD é’±åŒ…æ´¾ç”Ÿã€åœ°å€ç”Ÿæˆï¼‰
â”‚       â”‚   â”œâ”€â”€ TronListener.js        # TRON é“¾ç›‘å¬æœåŠ¡ï¼ˆè½®è¯¢ç”¨æˆ·å……å€¼åœ°å€ï¼Œæ¯ 10 ç§’ï¼‰
â”‚       â”‚   â”œâ”€â”€ TronCollectionService.js # TRON å½’é›†æœåŠ¡ï¼ˆApprove + TransferFromï¼‰
â”‚       â”‚   â”œâ”€â”€ CollectionRetryJob.js  # å½’é›†é‡è¯•é˜Ÿåˆ—æœåŠ¡
â”‚       â”‚   â”œâ”€â”€ GameOpenerService.js   # å¼€å¥–æœåŠ¡ï¼ˆé“¾ä¸Šå¼€å¥–ï¼‰
â”‚       â”‚   â”œâ”€â”€ BetQueueService.js     # æŠ•æ³¨é˜Ÿåˆ—æœåŠ¡ï¼ˆå¤„ç†æŠ•æ³¨è¯·æ±‚ï¼‰
â”‚       â”‚   â”œâ”€â”€ PayoutService.js       # è‡ªåŠ¨å‡ºæ¬¾æœåŠ¡ï¼ˆTRC20-USDT å‡ºæ¬¾ï¼‰
â”‚       â”‚   â”œâ”€â”€ PendingBetProcessor.js # å¾…å¤„ç†æŠ•æ³¨å¤„ç†å™¨
â”‚       â”‚   â”œâ”€â”€ WalletBalanceMonitor.js # é’±åŒ…ä½™é¢ç›‘æ§æœåŠ¡
â”‚       â”‚   â”œâ”€â”€ TronEnergyService.js   # TRON èƒ½é‡ç§ŸèµæœåŠ¡
â”‚       â”‚   â”œâ”€â”€ riskControlService.js  # é£æ§æœåŠ¡ï¼ˆåŒ IP æ£€æµ‹ï¼‰
â”‚       â”‚   â”œâ”€â”€ auditLogService.js     # å®¡è®¡æ—¥å¿—æœåŠ¡
â”‚       â”‚   â”œâ”€â”€ settingsCache.js       # ç³»ç»Ÿè®¾ç½®ç¼“å­˜æœåŠ¡
â”‚       â”‚   â”œâ”€â”€ UserService.js         # ç”¨æˆ·æœåŠ¡ï¼ˆç”¨æˆ·ç›¸å…³æ•°æ®åº“æ“ä½œï¼‰
â”‚       â”‚   â”œâ”€â”€ AdminService.js        # ç®¡ç†å‘˜æœåŠ¡ï¼ˆç®¡ç†å‘˜ç›¸å…³æ•°æ®åº“æ“ä½œï¼‰
â”‚       â”‚   â”œâ”€â”€ GameService.js         # æ¸¸æˆæœåŠ¡ï¼ˆæ¸¸æˆç›¸å…³æ•°æ®åº“æ“ä½œï¼‰
â”‚       â”‚   â””â”€â”€ WithdrawalService.js   # ææ¬¾æœåŠ¡ï¼ˆææ¬¾ç›¸å…³æ•°æ®åº“æ“ä½œï¼‰
â”‚       â”‚
â”‚       â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ safeResponse.js        # API å“åº”æ ‡å‡†åŒ–ï¼ˆsendSuccessã€sendErrorï¼‰
â”‚       â”‚   â”œâ”€â”€ maskUtils.js           # æ•æ„Ÿæ•°æ®è„±æ•ï¼ˆåœ°å€ã€äº¤æ˜“å“ˆå¸Œï¼‰
â”‚       â”‚   â”œâ”€â”€ balanceChangeLogger.js # è´¦å˜è®°å½•å·¥å…·
â”‚       â”‚   â”œâ”€â”€ gameUtils.js           # æ¸¸æˆå·¥å…·å‡½æ•°
â”‚       â”‚   â””â”€â”€ ipUtils.js             # IP å·¥å…·å‡½æ•°ï¼ˆè·å–çœŸå® IPã€è®¾å¤‡ IDã€å›½å®¶ï¼‰
â”‚       â”‚
â”‚       â”œâ”€â”€ validators/                # è¾“å…¥éªŒè¯
â”‚       â”‚   â””â”€â”€ authValidators.js      # è®¤è¯è¾“å…¥éªŒè¯ï¼ˆæ³¨å†Œã€ç™»å½•ã€ææ¬¾ï¼‰
â”‚       â”‚
â”‚       â”œâ”€â”€ scripts/                   # ç»´æŠ¤è„šæœ¬
â”‚       â”‚   â”œâ”€â”€ run-migration.js       # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚       â”‚   â”œâ”€â”€ prepare-test-data.js   # æµ‹è¯•æ•°æ®å‡†å¤‡è„šæœ¬
â”‚       â”‚   â”œâ”€â”€ update-password-fingerprints.js # å¯†ç æŒ‡çº¹æ›´æ–°è„šæœ¬
â”‚       â”‚   â””â”€â”€ README.md              # è„šæœ¬ä½¿ç”¨è¯´æ˜
â”‚       â”‚
â”‚       â”œâ”€â”€ tests/                     # è‡ªåŠ¨åŒ–æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test-runner.js         # æµ‹è¯•è¿è¡Œå™¨ï¼ˆAPI æµ‹è¯•ã€é”™è¯¯å¤„ç†æµ‹è¯•ã€å›å½’æµ‹è¯•ï¼‰
â”‚       â”‚   â”œâ”€â”€ run-all-tests.sh       # æµ‹è¯•æ‰§è¡Œè„šæœ¬
â”‚       â”‚   â””â”€â”€ README.md              # æµ‹è¯•æ–‡æ¡£
â”‚       â”‚
â”‚       â”œâ”€â”€ v1_frontend/               # æ—§ç‰ˆå‰ç«¯ï¼ˆå·²å¼ƒç”¨ï¼Œä¿ç•™ç”¨äºå…¼å®¹ï¼‰
â”‚       â”‚   â”œâ”€â”€ index.html
â”‚       â”‚   â”œâ”€â”€ app.js
â”‚       â”‚   â””â”€â”€ style.css
â”‚       â”‚
â”‚       â”œâ”€â”€ server.js                  # æœåŠ¡å™¨å…¥å£ï¼ˆExpressã€Socket.IOã€Passport.jsï¼‰
â”‚       â””â”€â”€ package.json               # ä¾èµ–é…ç½®
â”‚
â”œâ”€â”€ packages/                          # å…±äº«åŒ…ç›®å½•
â”‚   â”œâ”€â”€ database/                      # æ•°æ®åº“è¿æ¥å’Œè¿ç§»åŒ… (@flipcoin/database)
â”‚   â”‚   â”œâ”€â”€ index.js                   # æ•°æ®åº“è¿æ¥ï¼ˆPostgreSQLï¼‰
â”‚   â”‚   â”œâ”€â”€ migrations/                # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â”‚   â”‚   â”œâ”€â”€ add_admin_ip_125_229_37_48.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ add_admin_last_login_ip.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ add_admin_profile_fields.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ add_energy_rental_support.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ add_game_code_column.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ add_platform_name_setting.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ add_tron_system_upgrade.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ create_balance_changes_table.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ create_games_table_manual.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ create_tron_notifications_table.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ create_tron_notifications_table_manual.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ fix_collection_cursor_schema.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ init_i18n_settings.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ migrate_flipcoin_to_games.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ update_admin_ip_whitelist_local_only.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ update_bets_payout_multiplier_to_decimal.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ update_payout_multiplier_to_decimal_simple.sql
â”‚   â”‚   â”‚   â””â”€â”€ update_payout_multiplier_to_decimal.sql
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ ui/                            # å…±äº« UI ç»„ä»¶åŒ… (@flipcoin/ui)
â”‚       â””â”€â”€ package.json               # ï¼ˆé¢„ç•™ï¼Œæœªæ¥å¯å…±äº« UI ç»„ä»¶ï¼‰
â”‚
â”œâ”€â”€ services/                          # æœåŠ¡ç›®å½•
â”‚   â””â”€â”€ wallet/                        # é’±åŒ…æœåŠ¡ (@flipcoin/service-wallet)
â”‚       â””â”€â”€ package.json               # ğŸ›¡ï¸ é«˜å®‰å…¨åŒºåŸŸï¼ˆé¢„ç•™ï¼Œæœªæ¥å¯ç‹¬ç«‹éƒ¨ç½²ï¼‰
â”‚
â”œâ”€â”€ nginx/                             # Nginx é…ç½®
â”‚   â”œâ”€â”€ default.conf                   # Nginx é»˜è®¤é…ç½®ï¼ˆè·¯ç”±è§„åˆ™ï¼‰
â”‚   â”œâ”€â”€ nginx.conf                     # Nginx ä¸»é…ç½®
â”‚   â”œâ”€â”€ docker-entrypoint.sh          # Docker å…¥å£è„šæœ¬
â”‚   â””â”€â”€ Dockerfile                     # Nginx Dockerfile
â”‚
â”œâ”€â”€ modules/                           # æ—§ç‰ˆå‰ç«¯æ¨¡å—ï¼ˆå·²å¼ƒç”¨ï¼Œä¿ç•™ç”¨äºå…¼å®¹ï¼‰
â”‚   â”œâ”€â”€ api.js                         # æ—§ç‰ˆ API æ¨¡å—
â”‚   â”œâ”€â”€ auth.js                        # æ—§ç‰ˆè®¤è¯æ¨¡å—
â”‚   â”œâ”€â”€ game.js                        # æ—§ç‰ˆæ¸¸æˆæ¨¡å—
â”‚   â”œâ”€â”€ history.js                     # æ—§ç‰ˆå†å²æ¨¡å—
â”‚   â”œâ”€â”€ leaderboard.js                 # æ—§ç‰ˆæ’è¡Œæ¦œæ¨¡å—
â”‚   â”œâ”€â”€ notify.js                      # æ—§ç‰ˆé€šçŸ¥æ¨¡å—
â”‚   â”œâ”€â”€ socket.js                      # æ—§ç‰ˆ Socket.IO æ¨¡å—
â”‚   â”œâ”€â”€ state.js                       # æ—§ç‰ˆçŠ¶æ€ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ ui.js                          # æ—§ç‰ˆ UI æ¨¡å—
â”‚   â””â”€â”€ wallet.js                      # æ—§ç‰ˆé’±åŒ…æ¨¡å—
â”‚
â”œâ”€â”€ migrations/                        # æ ¹ç›®å½•è¿ç§»æ–‡ä»¶ï¼ˆå†å²é—ç•™ï¼‰
â”‚   â”œâ”€â”€ add_streak_multipliers.sql
â”‚   â””â”€â”€ fix_payout_multiplier_type.sql
â”‚
â”œâ”€â”€ docker-compose.yml                 # Docker Compose é…ç½®
â”œâ”€â”€ init.sql                           # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ pnpm-workspace.yaml                # pnpm workspace é…ç½®
â”œâ”€â”€ turbo.json                         # Turbo æ„å»ºé…ç½®
â”œâ”€â”€ package.json                       # æ ¹ package.jsonï¼ˆMonorepo é…ç½®ï¼‰
â”œâ”€â”€ PROJECT_CONSTITUTION.md            # é¡¹ç›®å¼€å‘å®ªæ³•ï¼ˆå¼€å‘è§„èŒƒï¼‰
â””â”€â”€ CHANGELOG.md                       # å˜æ›´æ—¥å¿—
```

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **Node.js 18+** - è¿è¡Œç¯å¢ƒ
- **Express 5** - Web æ¡†æ¶
- **PostgreSQL 14+** - å…³ç³»å‹æ•°æ®åº“
- **Socket.IO 4** - å®æ—¶é€šä¿¡ï¼ˆWebSocketï¼‰
- **Passport.js** - èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼ˆJWTã€Local Strategyï¼‰
- **TronWeb** - TRON åŒºå—é“¾äº¤äº’
- **ethers.js 6** - EVM åŒºå—é“¾äº¤äº’ï¼ˆBSCã€ETHã€Polygonï¼‰
- **bcryptjs** - å¯†ç åŠ å¯†
- **jsonwebtoken** - JWT Token ç”Ÿæˆå’ŒéªŒè¯
- **speakeasy** - Google äºŒæ¬¡éªŒè¯ï¼ˆ2FAï¼‰

### å‰ç«¯ (Vue 3)
- **Vue 3** - å‰ç«¯æ¡†æ¶ï¼ˆComposition APIï¼‰
- **Vue Router 4** - è·¯ç”±ç®¡ç†
- **Pinia** - çŠ¶æ€ç®¡ç†ï¼ˆæ›¿ä»£ Vuexï¼‰
- **Vite** - æ„å»ºå·¥å…·
- **Tailwind CSS 3** - æ ·å¼æ¡†æ¶
- **Socket.IO Client** - å®æ—¶é€šä¿¡å®¢æˆ·ç«¯
- **vue-i18n** - å¤šè¯­ç³»æ”¯æŒ
- **Element Plus** - UI ç»„ä»¶åº“ï¼ˆéƒ¨åˆ†ç»„ä»¶ï¼‰
- **Notyf** - é€šçŸ¥ç³»ç»Ÿ
- **Axios** - HTTP å®¢æˆ·ç«¯

### åå°ç®¡ç†
- **Vue 3** - å‰ç«¯æ¡†æ¶
- **Vue Router 4** - è·¯ç”±ç®¡ç†
- **Vuex** - çŠ¶æ€ç®¡ç†ï¼ˆæƒé™ç®¡ç†ï¼‰
- **Element Plus** - UI ç»„ä»¶åº“
- **ECharts** - æ•°æ®å¯è§†åŒ–
- **Axios** - HTTP å®¢æˆ·ç«¯

### å¼€å‘å·¥å…·
- **pnpm** - åŒ…ç®¡ç†å™¨ï¼ˆworkspace æ¨¡å¼ï¼‰
- **Turbo** - Monorepo æ„å»ºå·¥å…·
- **Docker & Docker Compose** - å®¹å™¨åŒ–éƒ¨ç½²
- **Nginx** - åå‘ä»£ç†å’Œé™æ€æ–‡ä»¶æœåŠ¡

## ğŸ“ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### æ¸¸æˆåŠŸèƒ½
- âœ… **Flip Coin æŠ•æ³¨æ¸¸æˆ** - ç”¨æˆ·å¯é€‰æ‹©æ­£é¢æˆ–åé¢è¿›è¡ŒæŠ•æ³¨
- âœ… **å®æ—¶å¼€å¥–** - é“¾ä¸Šå¼€å¥–ï¼Œç¡®ä¿å…¬å¹³é€æ˜
- âœ… **è¿èƒœè®°å½•** - è®°å½•ç”¨æˆ·è¿èƒœæ¬¡æ•°å’Œæœ€é«˜è¿èƒœ
- âœ… **æ’è¡Œæ¦œ** - å®æ—¶æ˜¾ç¤ºæŠ•æ³¨é‡‘é¢æ’è¡Œæ¦œ
- âœ… **æŠ•æ³¨å†å²** - ç”¨æˆ·å¯æŸ¥çœ‹æ‰€æœ‰æŠ•æ³¨è®°å½•

### é’±åŒ…åŠŸèƒ½
- âœ… **å¤šé“¾æ”¯æŒ** - TRC20ã€BSCã€ETHã€Polygonã€Solanaï¼ˆé¢„ç•™ï¼‰
- âœ… **HD é’±åŒ…åœ°å€åˆ†é…** - ç”¨æˆ·æ³¨å†Œæ—¶è‡ªåŠ¨åˆ†é…å”¯ä¸€å……å€¼åœ°å€
- âœ… **è‡ªåŠ¨å……å€¼ç›‘å¬** - TRON é“¾æ¯ 10 ç§’è½®è¯¢ç›‘å¬ç”¨æˆ·å……å€¼
- âœ… **è‡ªåŠ¨å½’é›†** - Approve + TransferFrom åŒç­¾åå½’é›†æ¨¡å¼
- âœ… **è‡ªåŠ¨å‡ºæ¬¾** - TRC20-USDT è‡ªåŠ¨å‡ºæ¬¾ï¼ˆå¯é…ç½®é˜ˆå€¼ï¼‰
- âœ… **å……å€¼/ææ¬¾å†å²** - å®Œæ•´çš„äº¤æ˜“è®°å½•æŸ¥è¯¢
- âœ… **ææ¬¾å¯†ç ä¿æŠ¤** - ææ¬¾éœ€éªŒè¯å¯†ç 

### åå°ç®¡ç†
- âœ… **ç”¨æˆ·ç®¡ç†** - ç”¨æˆ·åˆ—è¡¨ã€ä¿¡æ¯æ›´æ–°ã€çŠ¶æ€ç®¡ç†ã€å……å€¼åœ°å€æŸ¥è¯¢
- âœ… **æŠ•æ³¨ç®¡ç†** - æŠ•æ³¨åˆ—è¡¨ã€ç›ˆäºæŠ¥è¡¨
- âœ… **è´¢åŠ¡ç®¡ç†** - å……å€¼è®°å½•ã€æç°å®¡æ ¸ã€è´¦å˜è®°å½•
- âœ… **é’±åŒ…ç®¡ç†** - å¹³å°é’±åŒ… CRUDã€é’±åŒ…ç›‘æ§
- âœ… **æ¸¸æˆç®¡ç†** - æ¸¸æˆåˆ—è¡¨ã€æ¸¸æˆå‚æ•°è®¾ç½®
- âœ… **é£æ§ç®¡ç†** - åŒ IP ç›‘æ§ã€IP å°ç¦
- âœ… **ç³»ç»Ÿè®¾ç½®** - æ¸¸æˆå‚æ•°ã€ç”¨æˆ·ç­‰çº§ã€å¤šè¯­ç³»ã€åœ°åŒºå±è”½
- âœ… **ç®¡ç†å‘˜ç®¡ç†** - è´¦å·ç®¡ç†ã€æƒé™ç®¡ç†ã€IP ç™½åå•ã€å®¡è®¡æ—¥å¿—
- âœ… **å®æ—¶ä»ªè¡¨æ¿** - ç»Ÿè®¡æ•°æ®ã€åœ¨çº¿ç”¨æˆ·

## ğŸ’° ç”¨æˆ·é‡‘æµæµç¨‹

### 1. é’±åŒ…åœ°å€åˆ†é…æœºåˆ¶

#### 1.1 åˆ†é…æ–¹å¼
- **æŠ€æœ¯å®ç°**: ä½¿ç”¨ HD (Hierarchical Deterministic) é’±åŒ…æ´¾ç”Ÿ
- **ä¸»å¯†é’¥**: ä» `MASTER_MNEMONIC` (ç¯å¢ƒå˜é‡) æ´¾ç”Ÿæ‰€æœ‰å­é’±åŒ…
- **æ´¾ç”Ÿè·¯å¾„**:
  - EVM é“¾ (BSC/ETH/Polygon): `m/44'/60'/0'/0/{index}`
  - TRON é“¾: `m/44'/195'/0'/0/{index}`

#### 1.2 ç´¢å¼•åˆ†é…è§„åˆ™
- **å¹³å°ä¿ç•™ç´¢å¼•**: 0-999999 (ç´¢å¼• 0-999999 ä¿ç•™ç»™å¹³å°å†…éƒ¨ä½¿ç”¨)
- **ç”¨æˆ·èµ·å§‹ç´¢å¼•**: ä»ç¯å¢ƒå˜é‡ `WALLET_START_INDEX` è¯»å–ï¼ˆé»˜è®¤ 1000000ï¼‰
- **åˆ†é…é€»è¾‘**: 
  - æ³¨å†Œæ—¶è°ƒç”¨ `KmsService.getNewDepositWallets()`
  - ä½¿ç”¨ `SELECT ... FOR UPDATE NOWAIT` ç¡®ä¿å¹¶å‘å®‰å…¨
  - æŸ¥è¯¢æ•°æ®åº“ä¸­ `deposit_path_index` çš„æœ€å¤§å€¼
  - æ–°ç´¢å¼• = `MAX(æœ€å¤§ç´¢å¼• + 1, WALLET_START_INDEX)`
  - åŒæ—¶ç”Ÿæˆ EVM å’Œ TRON ä¸¤ä¸ªåœ°å€
  - æ”¯æŒé‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š 3 æ¬¡ï¼ŒæŒ‡æ•°é€€é¿ï¼‰

#### 1.3 åœ°å€å­˜å‚¨
- ç”¨æˆ·æ³¨å†Œæ—¶ï¼Œ`deposit_path_index`ã€`evm_deposit_address`ã€`tron_deposit_address` å†™å…¥ `users` è¡¨
- ç§é’¥ä¸å­˜å‚¨ï¼Œéœ€è¦æ—¶é€šè¿‡ `KmsService.getPrivateKey(chainType, index)` åŠ¨æ€æ´¾ç”Ÿ

### 2. ç”¨æˆ·å……å€¼ç›‘å¬æœºåˆ¶

#### 2.1 ç›‘å¬æ–¹å¼
- **æœåŠ¡**: `TronListener.js`
- **ç›‘å¬é¢‘ç‡**: **æ¯ 10 ç§’è½®è¯¢ä¸€æ¬¡** (`POLLING_INTERVAL_MS = 10000`)
- **ç›‘å¬èŒƒå›´**: æ‰€æœ‰å·²æ³¨å†Œç”¨æˆ·çš„ TRON å……å€¼åœ°å€
- **API ç«¯ç‚¹**: `/wallet/getnowblock` (TronGrid API)
- **åŒºå—åŒæ­¥**: ä½¿ç”¨ `blockchain_sync_status` è¡¨ä¿å­˜æœ€åæ‰«æçš„åŒºå—é«˜åº¦

#### 2.2 ç›‘å¬å†…å®¹
1. **TRC20-USDT å……å€¼**:
   - API: `v1/accounts/{address}/transactions/trc20`
   - è¿‡æ»¤æ¡ä»¶: `only_to=true`, `only_confirmed=true`, `contract_address=USDT_CONTRACT`
   - USDT åˆçº¦åœ°å€ (Nile æµ‹è¯•ç½‘): `TG3XXyExBkPp9nzdajDZsozEu4BkaSJozs`

2. **TRX äº¤æ˜“è®°å½•**:
   - API: `v1/accounts/{address}/transactions`
   - è¿‡æ»¤æ¡ä»¶: `only_to=true`, `only_confirmed=true`, `TransferContract` ç±»å‹
   - ç”¨é€”: ä»…è®°å½•ç”¨æˆ·æ”¶åˆ° TRX çš„äº¤æ˜“ï¼ˆç±»å‹ä¸º `deposit_trx`ï¼‰
   - **æ³¨æ„**: 
     - ä»…è®°å½•åˆ° `platform_transactions` è¡¨ï¼Œ**ä¸ä¼šæ›´æ–°ç”¨æˆ·ä½™é¢**
     - **ä¸ä¼šè‡ªåŠ¨æ¿€æ´»åœ°å€**ï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œæ¿€æ´»æˆ–é€šè¿‡å…¶ä»–æ–¹å¼æ¿€æ´»
     - ä¸»è¦ç”¨äºäº¤æ˜“å†å²è®°å½•å’Œå®¡è®¡

#### 2.3 å¤„ç†æµç¨‹
1. è½®è¯¢æ‰€æœ‰ç”¨æˆ·çš„ `tron_deposit_address`
2. æŸ¥è¯¢æ¯ä¸ªåœ°å€çš„æœ€è¿‘äº¤æ˜“ï¼ˆåŸºäºåŒºå—é«˜åº¦å¢é‡æŸ¥è¯¢ï¼‰
3. æ£€æŸ¥äº¤æ˜“æ˜¯å¦å·²å¤„ç†ï¼ˆæŸ¥è¯¢ `platform_transactions` è¡¨ï¼‰
4. å¤„ç†æ–°äº¤æ˜“:
   - **TRC20-USDT å……å€¼**:
     - æ›´æ–°ç”¨æˆ·ä½™é¢ (`users.balance`)
     - è®°å½•äº¤æ˜“æµæ°´ (`platform_transactions`, ç±»å‹: `deposit`)
     - è®°å½•è´¦å˜ (`balance_changes`)
     - é€šè¿‡ Socket.IO å®æ—¶é€šçŸ¥ç”¨æˆ·
   - **TRX äº¤æ˜“**:
     - ä»…è®°å½•äº¤æ˜“æµæ°´ (`platform_transactions`, ç±»å‹: `deposit_trx`)
     - **ä¸æ›´æ–°ç”¨æˆ·ä½™é¢**ï¼ˆTRX ä¸æ˜¯å¹³å°æ”¯æŒçš„å……å€¼å¸ç§ï¼‰
     - **ä¸æ¿€æ´»åœ°å€**ï¼ˆç³»ç»Ÿä¸å†è‡ªåŠ¨æ¿€æ´»ï¼‰

#### 2.4 åŒºå—é«˜åº¦ç®¡ç†
- ä½¿ç”¨ `blockchain_sync_status` è¡¨è¿½è¸ªæœ€åæ‰«æçš„åŒºå—é«˜åº¦
- æ¯æ¬¡è½®è¯¢åæ›´æ–°åŒºå—é«˜åº¦
- æœåŠ¡é‡å¯åä»æ•°æ®åº“æ¢å¤æ‰«æè¿›åº¦

### 3. ç”¨æˆ·å……å€¼åœ°å€å½’é›†æœºåˆ¶

#### 3.1 å½’é›†æ–¹å¼
- **æœåŠ¡**: `TronCollectionService.js`
- **å½’é›†æ¨¡å¼**: **Approve + TransferFrom** (åŒç­¾åæ¨¡å¼)
  - ç”¨æˆ·åœ°å€æ‰§è¡Œ `approve()`: æˆæƒå½’é›†é’±åŒ…å¯è½¬å‡º USDTï¼ˆä¸æ¶ˆè€—èƒ½é‡å’Œ TRXï¼‰
  - å½’é›†é’±åŒ…æ‰§è¡Œ `transferFrom()`: å®é™…è½¬å‡º USDTï¼ˆæ¶ˆè€—èƒ½é‡ï¼‰

#### 3.2 å½’é›†é’±åŒ…é…ç½®
- **å½’é›†é’±åŒ…**: ä» `platform_wallets` è¡¨è¯»å– `is_collection=true` çš„é’±åŒ…
- **æ³¨æ„**: ç³»ç»Ÿä¸å†è‡ªåŠ¨æ¿€æ´»ç”¨æˆ·åœ°å€ï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œæ¿€æ´»æˆ–é€šè¿‡å…¶ä»–æ–¹å¼æ¿€æ´»åœ°å€

#### 3.3 å½’é›†è§¦å‘æ¡ä»¶
1. **æ‰«æé—´éš”**: ç”± `collection_settings.scan_interval_days` æ§åˆ¶ï¼ˆé»˜è®¤æŒ‰å¤©æ‰«æï¼‰
2. **å½’é›†æ¡ä»¶** (éœ€åŒæ—¶æ»¡è¶³):
   - ç”¨æˆ· USDT ä½™é¢ > 0
   - è·ç¦»ä¸Šæ¬¡å……å€¼æ—¶é—´ >= `days_without_deposit` å¤©
   - æˆ–ç”¨æˆ·åˆ›å»ºæ—¶é—´ >= `days_without_deposit` å¤©ï¼ˆæ— å……å€¼è®°å½•æ—¶ï¼‰
   - æ—  pending çŠ¶æ€çš„å½’é›†è®°å½•

#### 3.4 å½’é›†æ‰§è¡Œæµç¨‹
1. **æ£€æŸ¥æ‰«æé—´éš”**: æŸ¥è¯¢ `collection_cursor` è¡¨ï¼Œåˆ¤æ–­æ˜¯å¦åˆ°è¾¾æ‰«ææ—¶é—´
2. **èƒ½é‡ç®¡ç†**:
   - è·å–å½’é›†é’±åŒ…å½“å‰èƒ½é‡
   - è®¡ç®—å¹³å‡èƒ½é‡æ¶ˆè€—ï¼ˆä»å†å² `collection_logs` ç»Ÿè®¡ï¼Œé»˜è®¤ 35000ï¼‰
   - ä¼°ç®—å¯å¤„ç†åœ°å€æ•°é‡ = `å½“å‰èƒ½é‡ / å¹³å‡èƒ½é‡æ¶ˆè€—`
3. **æ‰¹é‡å¤„ç†**:
   - æŒ‰ `user_id` é¡ºåºæŸ¥è¯¢ç”¨æˆ·ï¼ˆæ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼‰
   - æ£€æŸ¥æ¯ä¸ªç”¨æˆ·æ˜¯å¦ç¬¦åˆå½’é›†æ¡ä»¶
   - æ£€æŸ¥å¹¶æ‰§è¡Œ `approve()`ï¼ˆå¦‚æœ allowance < balanceï¼‰
   - æ‰§è¡Œ `transferFrom()` å½’é›†
   - è®°å½•å½’é›†æ—¥å¿—åˆ° `collection_logs` è¡¨
   - **æ³¨æ„**: ç³»ç»Ÿä¸å†è‡ªåŠ¨æ¿€æ´»ç”¨æˆ·åœ°å€ï¼Œæœªæ¿€æ´»çš„åœ°å€å°†æ— æ³•å½’é›†
4. **æ–­ç‚¹ç»­ä¼ **: ä½¿ç”¨ `collection_cursor` è®°å½•æœ€åå¤„ç†çš„ `user_id`ï¼Œä¸‹æ¬¡ä»è¯¥ä½ç½®ç»§ç»­
5. **å¤±è´¥é‡è¯•**: ä½¿ç”¨ `collection_retry_queue` è¡¨ç®¡ç†å¤±è´¥çš„é‡è¯•ä»»åŠ¡ï¼Œæ”¯æŒæŒ‡æ•°é€€é¿

### 4. è‡ªåŠ¨å‡ºæ¬¾æœºåˆ¶

#### 4.1 å‡ºæ¬¾é’±åŒ…
- **å‡ºæ¬¾é’±åŒ…**: ä» `platform_wallets` è¡¨è¯»å– `is_payout=true` çš„é’±åŒ…
- **ç§é’¥é…ç½®**: é€šè¿‡ç¯å¢ƒå˜é‡ `TRON_PK_{address}` é…ç½®
- **å‡ºæ¬¾æ–¹å¼**: ç›´æ¥æ‰§è¡Œ TRC20-USDT `transfer()` äº¤æ˜“

#### 4.2 è‡ªåŠ¨å‡ºæ¬¾è§¦å‘æ¡ä»¶
éœ€åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶:
1. **ç³»ç»Ÿè®¾ç½®**: `AUTO_WITHDRAW_THRESHOLD > 0` (åœ¨ `system_settings` è¡¨ä¸­é…ç½®)
2. **é‡‘é¢é™åˆ¶**: ææ¬¾é‡‘é¢ <= `AUTO_WITHDRAW_THRESHOLD`
3. **é“¾ç±»å‹**: `chain_type = 'TRC20'` (ç›®å‰ä»…æ”¯æŒ TRC20)
4. **æœåŠ¡å°±ç»ª**: `PayoutService` å·²åˆå§‹åŒ–ä¸”é’±åŒ…å·²åŠ è½½

#### 4.3 å‡ºæ¬¾æµç¨‹
1. **ç”¨æˆ·æäº¤ææ¬¾è¯·æ±‚**:
   - éªŒè¯ææ¬¾å¯†ç 
   - æ£€æŸ¥ä½™é¢æ˜¯å¦å……è¶³
   - æ‰£é™¤ç”¨æˆ·ä½™é¢
   - åˆ›å»º `withdrawals` è®°å½•

2. **åˆ¤æ–­æ˜¯å¦è‡ªåŠ¨å‡ºæ¬¾**:
   - ç¬¦åˆæ¡ä»¶ â†’ `status = 'processing'`ï¼Œå¼‚æ­¥æ‰§è¡Œé“¾ä¸Šå‡ºæ¬¾
   - ä¸ç¬¦åˆæ¡ä»¶ â†’ `status = 'pending'`ï¼Œç­‰å¾…äººå·¥å®¡æ ¸

3. **è‡ªåŠ¨å‡ºæ¬¾æ‰§è¡Œ** (å¼‚æ­¥):
   - è°ƒç”¨ `PayoutService.sendTrc20Payout()`
   - æ„å»ºå¹¶ç­¾å TRC20-USDT `transfer()` äº¤æ˜“
   - å¹¿æ’­äº¤æ˜“åˆ°é“¾ä¸Š
   - æ›´æ–° `withdrawals.status = 'completed'` å¹¶è®°å½• `tx_hash`
   - å¦‚æœå¤±è´¥ï¼Œå›é€€çŠ¶æ€ä¸º `pending`ï¼Œç­‰å¾…äººå·¥å®¡æ ¸

#### 4.4 äº¤æ˜“è´¹ç”¨
- **Gas è´¹ç”¨**: è‡ªåŠ¨å‡ºæ¬¾ä½¿ç”¨ TRX ä½œä¸º Gasï¼ˆä¸æ¶ˆè€—èƒ½é‡ï¼‰
- **è´¹ç”¨é™é¢**: `feeLimit = 15000000` (15 TRX)
- **è´¹ç”¨æ¥æº**: å‡ºæ¬¾é’±åŒ…éœ€æŒæœ‰è¶³å¤Ÿçš„ TRX

### 5. è´¨æŠ¼èƒ½é‡ä¸äº¤æ˜“è´¹ç”¨

#### 5.1 èƒ½é‡ä½¿ç”¨åœºæ™¯
1. **å½’é›†äº¤æ˜“** (`transferFrom`):
   - å½’é›†é’±åŒ…æ¶ˆè€—è‡ªå·±çš„èƒ½é‡
   - å¹³å‡æ¶ˆè€—: ~35000 èƒ½é‡/ç¬”
   - èƒ½é‡æ¥æº: å½’é›†é’±åŒ…è´¨æŠ¼ TRX æˆ–è´­ä¹°èƒ½é‡

2. **ç”¨æˆ·åœ°å€æ¿€æ´»**:
   - Gas å‚¨å¤‡é’±åŒ…è½¬ 1 TRX ç»™ç”¨æˆ·åœ°å€
   - æ¶ˆè€— TRXï¼ˆéèƒ½é‡ï¼‰

#### 5.2 TRX ä½¿ç”¨åœºæ™¯
1. **è‡ªåŠ¨å‡ºæ¬¾** (`transfer`):
   - å‡ºæ¬¾é’±åŒ…æ¶ˆè€— TRX ä½œä¸º Gas
   - è´¹ç”¨é™é¢: 15 TRX/ç¬”

2. **åœ°å€æ¿€æ´»**:
   - **æ³¨æ„**: ç³»ç»Ÿä¸å†è‡ªåŠ¨æ¿€æ´»ç”¨æˆ·åœ°å€ï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œæ¿€æ´»æˆ–é€šè¿‡å…¶ä»–æ–¹å¼æ¿€æ´»

#### 5.3 é’±åŒ…è§’è‰²åˆ†å·¥
- **å½’é›†é’±åŒ…** (`is_collection=true`): æ‰§è¡Œå½’é›†ï¼Œæ¶ˆè€—èƒ½é‡
- **å‡ºæ¬¾é’±åŒ…** (`is_payout=true`): æ‰§è¡Œè‡ªåŠ¨å‡ºæ¬¾ï¼Œæ¶ˆè€— TRX
- **æ³¨æ„**: `Gas å‚¨å¤‡é’±åŒ…` åŠŸèƒ½å·²ç§»é™¤ï¼Œç³»ç»Ÿä¸å†è‡ªåŠ¨æ¿€æ´»ç”¨æˆ·åœ°å€

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… **IP ç™½åå•** - åå°ç®¡ç†éœ€é€šè¿‡ IP ç™½åå•éªŒè¯
- âœ… **é€Ÿç‡é™åˆ¶** - æ³¨å†Œã€ç™»å½•ã€ææ¬¾æ¥å£é™æµ
- âœ… **å¯†ç åŠ å¯†** - ä½¿ç”¨ bcrypt åŠ å¯†å­˜å‚¨å¯†ç 
- âœ… **JWT èº«ä»½éªŒè¯** - æ— çŠ¶æ€ Token è®¤è¯
- âœ… **è°·æ­ŒäºŒæ¬¡éªŒè¯ï¼ˆ2FAï¼‰** - ç®¡ç†å‘˜å¯å¯ç”¨ Google Authenticator
- âœ… **é£æ§ç³»ç»Ÿ** - åŒ IP æ£€æµ‹ã€IP å°ç¦
- âœ… **å®¡è®¡æ—¥å¿—** - æ‰€æœ‰å…³é”®æ“ä½œè®°å½•å®¡è®¡æ—¥å¿—
- âœ… **æ•æ„Ÿæ•°æ®è„±æ•** - åœ°å€ã€äº¤æ˜“å“ˆå¸Œåœ¨æ—¥å¿—ä¸­è„±æ•
- âœ… **API å“åº”æ ‡å‡†åŒ–** - ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼Œä¸æš´éœ²å†…éƒ¨é”™è¯¯
- âœ… **è¾“å…¥éªŒè¯** - æ³¨å†Œã€ç™»å½•ã€ææ¬¾ç­‰æ¥å£è¾“å…¥éªŒè¯
- âœ… **å¹¶å‘æ§åˆ¶** - ç”¨æˆ·æ³¨å†Œæ—¶çš„ç´¢å¼•åˆ†é…ä½¿ç”¨æ•°æ®åº“è¡Œé”

## ğŸ“ å¼€å‘è§„èŒƒ

æœ¬é¡¹ç›®ä¸¥æ ¼éµå¾ª **PROJECT_CONSTITUTION.md** çš„å¼€å‘è§„èŒƒï¼š

### æ¶æ„è§„åˆ™
- âœ… ä¸¥æ ¼çš„å‰åç«¯åˆ†ç¦»
- âœ… æœåŠ¡å±‚æŠ½è±¡ï¼ˆæ•°æ®åº“é€»è¾‘åœ¨ services ä¸­ï¼‰
- âœ… è·¯ç”±å±‚ä»…è´Ÿè´£éªŒè¯ã€è°ƒç”¨æœåŠ¡ã€æ ¼å¼åŒ–å“åº”
- âœ… æ¨¡å—åŒ–è®¾è®¡ï¼ˆæ–‡ä»¶ä¸è¶…è¿‡ 400 è¡Œï¼‰

### API è§„èŒƒ
- âœ… ç»Ÿä¸€å“åº”æ ¼å¼ï¼š
  - æˆåŠŸ: `{ "success": true, "data": ... }`
  - é”™è¯¯: `{ "success": false, "error": "message" }`
- âœ… ä½¿ç”¨ `sendSuccess` å’Œ `sendError` å·¥å…·å‡½æ•°
- âœ… é”™è¯¯æ¶ˆæ¯è„±æ•ï¼ˆä¸æš´éœ²å†…éƒ¨é”™è¯¯ï¼‰

### å‰ç«¯è§„èŒƒ
- âœ… ç»Ÿä¸€ API æ¨¡å—ï¼ˆç¦æ­¢ç›´æ¥ä½¿ç”¨ `fetch()`ï¼‰
- âœ… ç»„ä»¶å¤§å°é™åˆ¶ï¼ˆ< 300 è¡Œï¼‰
- âœ… ä½¿ç”¨ Design System tokensï¼ˆspacingã€radiusã€colorsï¼‰
- âœ… å“åº”å¼è®¾è®¡ï¼ˆWebã€Tabletã€Mobileï¼‰
- âœ… é«˜å¯†åº¦ UIï¼ˆèµŒåœºçº§è§†è§‰å¯†åº¦ï¼‰

### ä»£ç è´¨é‡
- âœ… å‘½åè§„èŒƒï¼ˆcamelCase å˜é‡/å‡½æ•°ï¼ŒPascalCase ç±»/ç»„ä»¶ï¼‰
- âœ… æ–‡ä»¶å‘½åä¸å¯¼å…¥è·¯å¾„ä¸€è‡´ï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰
- âœ… ç¦æ­¢ç‰ˆæœ¬æ³¨é‡Šï¼ˆä½¿ç”¨ CHANGELOG.mdï¼‰

è¯¦ç»†è§„èŒƒè¯·å‚è€ƒ [PROJECT_CONSTITUTION.md](./PROJECT_CONSTITUTION.md)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- **Docker & Docker Compose** - å®¹å™¨åŒ–éƒ¨ç½²
- **Node.js 18+** - å¼€å‘æ¨¡å¼éœ€è¦
- **pnpm 8+** - åŒ…ç®¡ç†å™¨
- **PostgreSQL 14+** - æ•°æ®åº“ï¼ˆæˆ–ä½¿ç”¨ Dockerï¼‰

### å¯åŠ¨é¡¹ç›®

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd flip_coin

# 2. å®‰è£…ä¾èµ–
pnpm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å¿…è¦çš„é…ç½®ï¼š
# - MASTER_MNEMONIC: HD é’±åŒ…ä¸»å¯†é’¥ï¼ˆå¿…é¡»ä¿å¯†ï¼‰
# - JWT_SECRET: JWT å¯†é’¥
# - DATABASE_URL: æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
# - NILE_LISTENER_HOST: TRON èŠ‚ç‚¹åœ°å€
# - WALLET_START_INDEX: ç”¨æˆ·é’±åŒ…èµ·å§‹ç´¢å¼•ï¼ˆé»˜è®¤ 1000000ï¼‰

# 4. å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# 5. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### è®¿é—®åœ°å€

- **å‰ç«¯**: http://localhost:8080
- **åå°ç®¡ç†**: http://localhost:8080/admin
- **API**: http://localhost:8080/api/v1
- **æ•°æ®åº“**: localhost:5432

## ğŸ”§ å¼€å‘æ¨¡å¼

### å‰ç«¯å¼€å‘

```bash
cd apps/web
pnpm install
pnpm dev
```

å‰ç«¯å°†åœ¨ `http://localhost:5173` å¯åŠ¨ï¼ˆVite é»˜è®¤ç«¯å£ï¼‰

### åå°ç®¡ç†å¼€å‘

```bash
cd apps/admin
pnpm install
pnpm serve
```

åå°ç®¡ç†å°†åœ¨ `http://localhost:8081` å¯åŠ¨ï¼ˆVue CLI é»˜è®¤ç«¯å£ï¼‰

### åç«¯å¼€å‘

```bash
cd apps/backend-legacy
pnpm install
pnpm start
```

åç«¯å°†åœ¨ `http://localhost:3000` å¯åŠ¨

### æ•°æ®åº“è¿ç§»

```bash
# ä½¿ç”¨ Node.js è„šæœ¬
cd apps/backend-legacy
node scripts/run-migration.js <migration-file.sql>

# æˆ–ç›´æ¥ä½¿ç”¨ Docker
docker exec -i flipcoin-db psql -U game_user -d flipcoin_db < packages/database/migrations/<migration-file.sql>
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
cd apps/backend-legacy/tests
./run-all-tests.sh

# æˆ–ç›´æ¥è¿è¡Œæµ‹è¯•è„šæœ¬
node test-runner.js
```

## ğŸ“š æ–‡æ¡£

- [é¡¹ç›®å®ªæ³•](./PROJECT_CONSTITUTION.md) - å¼€å‘è§„èŒƒï¼ˆæœ€é«˜ç­‰çº§å¼€å‘è§„èŒƒï¼‰
- [å˜æ›´æ—¥å¿—](./CHANGELOG.md) - ç‰ˆæœ¬å˜æ›´è®°å½•
- [æµ‹è¯•æ–‡æ¡£](./apps/backend-legacy/tests/README.md) - è‡ªåŠ¨åŒ–æµ‹è¯•è¯´æ˜

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡**: ç¡®ä¿æ­£ç¡®é…ç½® `.env` æ–‡ä»¶
   - `MASTER_MNEMONIC`: HD é’±åŒ…ä¸»å¯†é’¥ï¼ˆå¿…é¡»ä¿å¯†ï¼Œä¸¢å¤±å°†æ— æ³•æ¢å¤ç”¨æˆ·åœ°å€ï¼‰
   - `JWT_SECRET`: JWT å¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²ï¼‰
   - `DATABASE_URL`: æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
   - `NILE_LISTENER_HOST`: TRON èŠ‚ç‚¹åœ°å€ï¼ˆæµ‹è¯•ç½‘æˆ–ä¸»ç½‘ï¼‰
   - `WALLET_START_INDEX`: ç”¨æˆ·é’±åŒ…èµ·å§‹ç´¢å¼•ï¼ˆé»˜è®¤ 1000000ï¼Œä¸è¦ç¡¬ç¼–ç ï¼‰

2. **æ•°æ®åº“**: é¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨æ‰§è¡Œ `init.sql` åˆå§‹åŒ–æ•°æ®åº“

3. **ç«¯å£**: é»˜è®¤ä½¿ç”¨ 8080 ç«¯å£ï¼Œå¯åœ¨ `.env` ä¸­ä¿®æ”¹ `NGINX_PORT`

4. **ç”Ÿäº§ç¯å¢ƒ**: éƒ¨ç½²å‰è¯·ä¿®æ”¹é»˜è®¤å¯†ç å’Œå¯†é’¥

5. **å¹¶å‘æ³¨å†Œ**: ç³»ç»Ÿå·²å®ç°å¹¶å‘æ§åˆ¶ï¼ˆæ•°æ®åº“è¡Œé”ï¼‰ï¼Œä½†é«˜å¹¶å‘åœºæ™¯ä¸‹ä»å»ºè®®ä½¿ç”¨è´Ÿè½½å‡è¡¡

6. **èƒ½é‡ç®¡ç†**: å½’é›†é’±åŒ…éœ€è¦è¶³å¤Ÿçš„èƒ½é‡ï¼Œå»ºè®®ç›‘æ§èƒ½é‡ä½™é¢å¹¶è®¾ç½®å‘Šè­¦

7. **å‡ºæ¬¾é’±åŒ…**: å‡ºæ¬¾é’±åŒ…éœ€è¦è¶³å¤Ÿçš„ TRX ä½œä¸º Gasï¼Œå»ºè®®ç›‘æ§ TRX ä½™é¢

8. **æ—§ç‰ˆæ–‡ä»¶**: æ ¹ç›®å½•ä¸‹çš„ `index.html`ã€`app.js`ã€`style.css`ã€`modules/` æ˜¯æ—§ç‰ˆå‰ç«¯æ–‡ä»¶ï¼Œå·²å¼ƒç”¨ä½†ä¿ç•™ç”¨äºå…¼å®¹ï¼Œæ–°å¼€å‘è¯·ä½¿ç”¨ `apps/web`

## ğŸ”„ é‡æ„å†å²

### ä¸»è¦é‡æ„å†…å®¹

1. **API å“åº”æ ‡å‡†åŒ–**: æ‰€æœ‰ API ç»Ÿä¸€ä½¿ç”¨ `{ success: true, data: ... }` æ ¼å¼
2. **è·¯ç”±æ¨¡å—åŒ–**: 
   - `server.js` è·¯ç”±æ‹†åˆ† â†’ `routes/v1/` (å‰å° API)
   - `admin.js` è·¯ç”±æ‹†åˆ† â†’ `routes/admin/` (åå° API)
3. **æœåŠ¡å±‚æŠ½è±¡**: åˆ›å»º `UserService`ã€`AdminService`ã€`GameService`ã€`WithdrawalService`
4. **å‰å° API é€‚é…**: ä¿®å¤æ‰€æœ‰å‰å° API å“åº”å¤„ç†ï¼Œé€‚é…æ ‡å‡†æ ¼å¼
5. **å……å€¼åœ°å€æ˜¾ç¤º**: ä¿®å¤å­—æ®µååŒ¹é…é—®é¢˜ï¼ˆ`tron_deposit_address`ã€`evm_deposit_address`ï¼‰
6. **å¹¶å‘æ§åˆ¶**: å®ç°ç”¨æˆ·æ³¨å†Œæ—¶çš„ç´¢å¼•åˆ†é…å¹¶å‘æ§åˆ¶ï¼ˆ`SELECT ... FOR UPDATE NOWAIT`ï¼‰
7. **åŒºå—åŒæ­¥**: å®ç°åŒºå—é«˜åº¦æŒä¹…åŒ–ï¼ˆ`blockchain_sync_status` è¡¨ï¼‰
8. **å½’é›†é‡è¯•**: å®ç°å½’é›†å¤±è´¥é‡è¯•æœºåˆ¶ï¼ˆ`collection_retry_queue` è¡¨ï¼‰
9. **å‰ç«¯é‡æ„**: ä»æ—§ç‰ˆå•æ–‡ä»¶æ¶æ„é‡æ„ä¸º Vue 3 SPA æ¶æ„
10. **Monorepo æ¶æ„**: ä½¿ç”¨ pnpm workspace ç®¡ç†å¤šä¸ªåº”ç”¨å’ŒåŒ…

è¯¦ç»†å˜æ›´è®°å½•è¯·å‚è€ƒ [CHANGELOG.md](./CHANGELOG.md)

## ğŸ“¦ æ¨¡å—ä¾èµ–æ¦‚è§ˆ

> **è¯´æ˜**: æ­¤éƒ¨åˆ†ç”¨äºå¸®åŠ© AI ç†è§£é¡¹ç›®å„æ¨¡å—çš„ä¾èµ–å…³ç³»å’ŒæŠ€æœ¯æ ˆï¼Œå®é™…å¼€å‘è¯·å‚è€ƒå„æ¨¡å—çš„ `package.json` æ–‡ä»¶ã€‚

### æ ¹ç›®å½• (Monorepo é…ç½®)

**æ–‡ä»¶**: `package.json`

```json
{
  "name": "flip-coin-monorepo",
  "version": "1.0.0",
  "workspaces": ["apps/*", "packages/*", "services/*"],
  "scripts": {
    "dev": "turbo run dev",
    "build": "turbo run build",
    "lint": "turbo run lint"
  },
  "devDependencies": {
    "turbo": "^2.0.0"
  },
  "engines": {
    "node": ">=18.0.0",
    "pnpm": ">=8.0.0"
  }
}
```

**è¯´æ˜**: 
- ä½¿ç”¨ pnpm workspace ç®¡ç† Monorepo
- ä½¿ç”¨ Turbo è¿›è¡Œæ„å»ºä¼˜åŒ–
- è¦æ±‚ Node.js 18+ å’Œ pnpm 8+

---

### åç«¯æœåŠ¡ (`apps/backend-legacy`)

**åŒ…å**: `@flipcoin/backend-legacy`

**æ ¸å¿ƒä¾èµ–**:
- `express: ^5.1.0` - Web æ¡†æ¶
- `pg: ^8.16.3` - PostgreSQL å®¢æˆ·ç«¯
- `socket.io: ^4.7.2` - WebSocket å®æ—¶é€šä¿¡
- `passport: ^0.7.0` + `passport-jwt: ^4.0.1` + `passport-local: ^1.0.0` - èº«ä»½éªŒè¯
- `jsonwebtoken: ^9.0.2` - JWT Token ç”Ÿæˆ
- `bcryptjs: ^3.0.2` - å¯†ç åŠ å¯†
- `tronweb: ^5.3.2` - TRON åŒºå—é“¾äº¤äº’
- `ethers: ^6.7.0` - EVM åŒºå—é“¾äº¤äº’ (BSC/ETH/Polygon)
- `bip39: ^3.1.0` + `hdkey: ^2.0.1` - HD é’±åŒ…æ´¾ç”Ÿ
- `speakeasy: ^2.0.0` - Google äºŒæ¬¡éªŒè¯ (2FA)
- `qrcode: ^1.5.4` - äºŒç»´ç ç”Ÿæˆ
- `nanoid: ^3.3.4` - å”¯ä¸€ ID ç”Ÿæˆ
- `cors: ^2.8.5` - CORS ä¸­é—´ä»¶
- `dotenv: ^16.3.1` - ç¯å¢ƒå˜é‡ç®¡ç†
- `http-proxy-middleware: ^3.0.5` - HTTP ä»£ç†ä¸­é—´ä»¶
- `@flipcoin/database: workspace:*` - æ•°æ®åº“è¿æ¥åŒ…ï¼ˆå†…éƒ¨ä¾èµ–ï¼‰

**è¯´æ˜**:
- ä¸»æœåŠ¡å™¨å…¥å£: `server.js`
- æ”¯æŒå¤šé“¾åŒºå—é“¾äº¤äº’ï¼ˆTRONã€EVM é“¾ï¼‰
- ä½¿ç”¨ HD é’±åŒ…ç®¡ç†ç”¨æˆ·å……å€¼åœ°å€
- å®ç°å®Œæ•´çš„ RBAC æƒé™ç³»ç»Ÿ

---

### å‰ç«¯åº”ç”¨ (`apps/web`)

**åŒ…å**: `@flipcoin/web`

**æ ¸å¿ƒä¾èµ–**:
- `vue: ^3.2.13` - Vue 3 æ¡†æ¶ï¼ˆComposition APIï¼‰
- `vue-router: ^4.0.3` - è·¯ç”±ç®¡ç†
- `vue-i18n: ^9.9.1` - å¤šè¯­ç³»æ”¯æŒ
- `axios: ^1.7.2` - HTTP å®¢æˆ·ç«¯
- `socket.io-client: ^4.7.2` - WebSocket å®¢æˆ·ç«¯
- `element-plus: ^2.7.7` - UI ç»„ä»¶åº“
- `@element-plus/icons-vue: ^2.3.2` - Element Plus å›¾æ ‡
- `notyf: ^3.10.0` - é€šçŸ¥ç³»ç»Ÿ

**å¼€å‘ä¾èµ–**:
- `vite: ^5.0.0` - æ„å»ºå·¥å…·
- `@vitejs/plugin-vue: ^4.5.0` - Vite Vue æ’ä»¶
- `tailwindcss: ^3.4.18` - CSS æ¡†æ¶
- `postcss: ^8.5.6` + `autoprefixer: ^10.4.22` - CSS å¤„ç†

**è¯´æ˜**:
- ä½¿ç”¨ Vite ä½œä¸ºæ„å»ºå·¥å…·
- ä½¿ç”¨ Tailwind CSS è¿›è¡Œæ ·å¼ç®¡ç†
- ä½¿ç”¨ Composition API ç¼–å†™ç»„ä»¶
- æ”¯æŒå¤šè¯­ç³»ï¼ˆç¹ä½“ä¸­æ–‡ã€ç®€ä½“ä¸­æ–‡ã€è‹±æ–‡ï¼‰

---

### åå°ç®¡ç† (`apps/admin`)

**åŒ…å**: `@flipcoin/admin`

**æ ¸å¿ƒä¾èµ–**:
- `vue: ^3.2.13` - Vue 3 æ¡†æ¶
- `vue-router: ^4.0.3` - è·¯ç”±ç®¡ç†
- `element-plus: ^2.7.7` - UI ç»„ä»¶åº“
- `@element-plus/icons-vue: ^2.3.2` - Element Plus å›¾æ ‡
- `axios: ^1.7.2` - HTTP å®¢æˆ·ç«¯
- `echarts: ^6.0.0` - æ•°æ®å¯è§†åŒ–å›¾è¡¨
- `jwt-decode: ^4.0.0` - JWT Token è§£ç 
- `core-js: ^3.8.3` - JavaScript å…¼å®¹æ€§åº“

**å¼€å‘ä¾èµ–**:
- `@vue/cli-service: ~5.0.0` - Vue CLI æœåŠ¡
- `@vue/cli-plugin-babel: ~5.0.0` - Babel æ’ä»¶
- `@vue/cli-plugin-router: ~5.0.0` - è·¯ç”±æ’ä»¶

**è¯´æ˜**:
- ä½¿ç”¨ Vue CLI ä½œä¸ºæ„å»ºå·¥å…·
- ä½¿ç”¨ Element Plus ä½œä¸º UI ç»„ä»¶åº“
- ä½¿ç”¨ ECharts è¿›è¡Œæ•°æ®å¯è§†åŒ–
- éœ€è¦ IP ç™½åå•éªŒè¯æ‰èƒ½è®¿é—®

---

### æ•°æ®åº“åŒ… (`packages/database`)

**åŒ…å**: `@flipcoin/database`

**æ ¸å¿ƒä¾èµ–**:
- `pg: ^8.16.3` - PostgreSQL å®¢æˆ·ç«¯

**è¯´æ˜**:
- æä¾›æ•°æ®åº“è¿æ¥å’Œè¿ç§»å·¥å…·
- åŒ…å«æ‰€æœ‰æ•°æ®åº“è¿ç§»è„šæœ¬ (`migrations/`)
- è¢« `@flipcoin/backend-legacy` å¼•ç”¨

---

### UI ç»„ä»¶åŒ… (`packages/ui`)

**åŒ…å**: `@flipcoin/ui`

**æ ¸å¿ƒä¾èµ–**: æ— ï¼ˆé¢„ç•™ï¼‰

**è¯´æ˜**:
- é¢„ç•™ç”¨äºå…±äº« UI ç»„ä»¶å’Œè®¾è®¡ç³»ç»Ÿ
- ç›®å‰ä¸ºç©ºï¼Œæœªæ¥å¯å…±äº«ç»„ä»¶åº“

---

### é’±åŒ…æœåŠ¡ (`services/wallet`)

**åŒ…å**: `@flipcoin/service-wallet`

**æ ¸å¿ƒä¾èµ–**: æ— ï¼ˆé¢„ç•™ï¼‰

**è¯´æ˜**:
- ğŸ›¡ï¸ **é«˜å®‰å…¨åŒºåŸŸ**ï¼Œé¢„ç•™ç”¨äºç‹¬ç«‹éƒ¨ç½²çš„é’±åŒ…æœåŠ¡
- æœªæ¥å¯é€šè¿‡ HTTP/gRPC è®¿é—®
- ç‰©ç†éš”ç¦»æ•æ„Ÿçš„é’±åŒ…æ“ä½œé€»è¾‘

---

## ğŸ“„ è®¸å¯è¯

[å¾…è¡¥å……]
